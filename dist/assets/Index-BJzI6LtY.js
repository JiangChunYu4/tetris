import{r as m,a as u,o as _e,w as Fe,b as we,c as B,d as D,e as be,f as i,F as ee,g as te,t as E,n as ae,p as ke,h as Ce}from"./index-DMTPpx5L.js";const Be={lineGradientLigthTheme:["linear-gradient(180deg, #FFA7EB 0%, #F026A8 100%)","linear-gradient(180deg, #DFA1FF 0%, #9A36F0 100%)","linear-gradient(180deg, #9EAAFF 0%, #3846F4 100%)","linear-gradient(180deg, #7BE7FF 0%, #1E85E2 100%)","linear-gradient(180deg, #89FED8 0%, #18C997 100%)","linear-gradient(180deg, #FFED48 0%, #FD9E16 100%)","linear-gradient(180deg, #FFBA8D 0%, #EB6423 100%)"],normalLightTheme:["#2B7AF5","#2B9DF5","#79CFFF","#1B67DD","#4F94FF","#2180F2","#3FD0FF"]},ne=[[0,1,0,2,1,2,2,2],[0,1,1,1,1,2,2,2],[1,1,1,2,2,1,2,2],[1,0,1,1,1,2,1,3],[0,2,1,1,1,2,2,1],[0,1,0,2,1,1,2,1],[1,1,2,0,2,1,2,2]],I=[[{x:1,y:1},{x:1,y:0},{x:0,y:-2},{x:-2,y:1}],[{x:1,y:1},{x:1,y:0},{x:0,y:-2},{x:-2,y:1}],[{x:0,y:1},{x:1,y:0},{x:0,y:-1},{x:-1,y:0}],[{x:-1,y:2},{x:1,y:1},{x:2,y:-1},{x:-2,y:-2}],[{x:2,y:0},{x:0,y:-1},{x:-1,y:-1},{x:-1,y:2}],[{x:1,y:1},{x:1,y:0},{x:0,y:-2},{x:-2,y:1}],[{x:0,y:0},{x:1,y:0},{x:-1,y:0},{x:0,y:0}]],oe=(h,o)=>{o.splice(0,o.length);for(let v=0;v<ne.length;v++){const p={position:ne[v],color:Be[h][v]};o.push(p)}},g=(h,o,v)=>h*v+o,De=(h,o)=>{const v=h.__vccOpts||h;for(const[p,l]of o)v[p]=l;return v},L=h=>(ke("data-v-ff7a9f6f"),h=h(),Ce(),h),Ie={class:"game-container"},Oe={key:0,class:"game-over"},Se={class:"main-frame"},Me={class:"sub-frame"},Re={class:"data-box"},Ae={class:"data-row"},Ee=L(()=>i("div",{class:"data-label"},"清除次数:",-1)),Le={class:"data"},Ge={class:"data-row"},Ne=L(()=>i("div",{class:"data-label"},"等级:",-1)),Te={class:"data"},Je={class:"data-row"},je=L(()=>i("div",{class:"data-label"},"分数:",-1)),Ue={class:"data"},Pe={class:"data-row"},Ve=L(()=>i("div",{class:"data-label"},"速度:",-1)),ze={class:"data"},Ke={__name:"Index",setup(h){const o=m([]),v=m([]),p=u(20),l=u(10),se=u(4),G=u(4),O=u("#eeeeee"),S=u("lineGradientLigthTheme"),k=m([]),f=m({index:0,transform:0}),w=m({index:0,transform:0});let s=m({}),A=m({});const y=m([]);let C=null;const V=u(800),M=u(V.value),le=u(100),re=u(40),b=u(!1),_=u(!1),z=u(0),R=u(1),N=u(0),ie=u(10),ce=()=>{for(let e=0;e<p.value;e++)for(let t=0;t<l.value;t++)o.push(m({data:0,bgColor:O.value}))},de=()=>{for(let e=0;e<se.value;e++)for(let t=0;t<G.value;t++)v.push(m({data:0,bgColor:O.value}))},x=(e,t,a,n)=>{const r=e.position;for(let c=0;c<r.length;c+=2)switch(n){case"clear":t[g(r[c],r[c+1],a)].bgColor=O.value;break;case"generate":t[g(r[c],r[c+1],a)].bgColor=e.color;break;case"fix":t[g(r[c],r[c+1],a)].data=1;break}},K=()=>{let e=Math.floor(Math.random()*k.length);for(;e===w.index;)e=Math.floor(Math.random()*k.length);w.index=e,w.transform=Math.floor(Math.random()*4)},q=()=>{f.index=w.index,f.transform=w.transform,s=JSON.parse(JSON.stringify(k[f.index])),X(s,o,l.value,f),K(),A.position&&x(A,v,G.value,"clear"),A=JSON.parse(JSON.stringify(k[w.index])),X(A,v,G.value,w)},ue=()=>{const e=s.position;for(let t=0;t<e.length;t+=2){if(e[t]>=p.value-1)return!1;const a=g(e[t]+1,e[t+1],l.value);if(o[a].data>0)return!1}return!0},ve=()=>{const e=s.position;for(let t=0;t<e.length;t+=2){const a=g(e[t],e[t+1]-1,l.value);if(e[t+1]<=0||o[a].data>0)return!1}return!0},fe=()=>{const e=s.position;for(let t=0;t<e.length;t+=2){const a=g(e[t],e[t+1]+1,l.value);if(e[t+1]>=l.value-1||o[a].data>0)return!1}return!0},xe=()=>{const e=JSON.parse(JSON.stringify(s)),t=f.transform,a=f.index,n=e.position,r=n[0],c=n[1];for(let d=0;d<n.length;d+=2){const F=n[d]-r,j=n[d+1]-c,U=r+I[a][t].x,P=c+I[a][t].y;if(n[d]=j+U,n[d+1]=-F+P,n[d+1]<0||n[d+1]>=l.value||n[d]>=p.value||o[g(n[d],n[d+1],l.value)].data>0)return!1}return!0},T=()=>{if(!(_.value||!b.value))if(ue()){x(s,o,l.value,"clear");for(let e=0;e<s.position.length;e+=2)s.position[e]++;x(s,o,l.value,"generate")}else x(s,o,l.value,"fix"),pe()},H=()=>{if(!(_.value||!b.value)&&ve()){x(s,o,l.value,"clear");for(let e=0;e<s.position.length;e+=2)s.position[e+1]--;x(s,o,l.value,"generate")}},Q=()=>{if(!(_.value||!b.value)&&fe()){x(s,o,l.value,"clear");for(let e=0;e<s.position.length;e+=2)s.position[e+1]++;x(s,o,l.value,"generate")}},W=()=>{if(!(_.value||!b.value)&&xe()){x(s,o,l.value,"clear");const e=s.position[0],t=s.position[1];for(let a=0;a<s.position.length;a+=2){const n=s.position[a]-e,r=s.position[a+1]-t,c=e+I[f.index][f.transform].x,d=t+I[f.index][f.transform].y;s.position[a]=r+c,s.position[a+1]=-n+d}f.transform=(f.transform+1)%4,x(s,o,l.value,"generate")}},X=(e,t,a,n)=>{x(e,t,a,"clear");for(let r=0;r<n.transform;r++){const c=e.position[0],d=e.position[1];for(let F=0;F<e.position.length;F+=2){const j=e.position[F]-c,U=e.position[F+1]-d,P=c+I[n.index][r].x,ye=d+I[n.index][r].y;e.position[F]=U+P,e.position[F+1]=-j+ye}}x(e,t,a,"generate")},he=e=>{z.value+=e*(e+1)/2*100*R.value},ge=()=>{N.value++,R.value=Math.max(R.value,Math.floor(N.value/ie.value)+1),M.value=V.value-(R.value-1)*re.value,M.value=Math.max(M.value,le.value),Y()},pe=()=>{let e=0;for(let t=p.value-1;t>=0;t--){let a=0;for(let n=0;n<l.value;n++)o[g(t,n,l.value)].data>0&&a++;if(a===0)break;a===l.value&&y.push(t),e++}if(e===p.value-1){J(),_.value=!0;return}if(y.length>0){for(let t=0;t<y.length;t++)for(let a=0;a<l.value;a++){const n=g(y[t],a,l.value);o[n].bgColor=O.value,o[n].data=0}for(let t=p.value-1;t>=0;t--){let a=0;for(;y[a]>t;)a++;if(a>0)for(let n=0;n<l.value;n++){const r=g(t,n,l.value);if(o[r].data>0){const c=g(t+a,n,l.value);o[c].data=o[r].data,o[c].bgColor=o[r].bgColor,o[r].data=0,o[r].bgColor=O.value}}}he(y.length),ge(),y.splice(0,y.length)}q()},Y=()=>{_.value||(b.value=!0,C&&clearInterval(C),C=setInterval(()=>{T()},M.value))},J=()=>{_.value||(b.value?(b.value=!1,clearInterval(C)):Y())},Z=()=>{S.value==="lineGradientLigthTheme"?S.value="normalLightTheme":S.value="lineGradientLigthTheme"},me=()=>{ce(),de()},$=e=>{switch(e.key){case"ArrowUp":W();break;case"ArrowDown":T();break;case"ArrowLeft":H();break;case"ArrowRight":Q();break;case"Enter":J();break;case"t":Z();break}};return _e(()=>{window.addEventListener("keydown",$),me(),oe(S.value,k),K(),q(),Fe(S,e=>{oe(e,k)})}),we(()=>{window.removeEventListener("keydown",$),C&&clearInterval(C)}),(e,t)=>(B(),D("div",Ie,[_.value?(B(),D("div",Oe,"Game Over")):be("",!0),i("div",Se,[(B(!0),D(ee,null,te(o,(a,n)=>(B(),D("div",{key:n,class:"cell",style:ae({background:a.bgColor})},null,4))),128))]),i("div",Me,[(B(!0),D(ee,null,te(v,(a,n)=>(B(),D("div",{key:n,class:"cell",style:ae({background:a.bgColor})},null,4))),128))]),i("div",{class:"operation-box"},[i("div",{class:"pause btn",onClick:J},"暂停"),i("div",{class:"btn",onClick:Z},"主题"),i("div",{class:"rotate btn",onClick:W},"旋转"),i("div",{class:"btn",onClick:H},"向左"),i("div",{class:"btn",onClick:Q},"向右"),i("div",{class:"move-down btn",onClick:T},"向下")]),i("div",Re,[i("div",Ae,[Ee,i("div",Le,E(N.value),1)]),i("div",Ge,[Ne,i("div",Te,E(R.value),1)]),i("div",Je,[je,i("div",Ue,E(z.value),1)]),i("div",Pe,[Ve,i("div",ze,E(M.value),1)])])]))}},He=De(Ke,[["__scopeId","data-v-ff7a9f6f"]]);export{He as default};

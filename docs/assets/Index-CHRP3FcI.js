import{r as _,a as d,o as Be,w as se,b as Me,c as b,d as k,e as l,F as le,f as re,t as G,n as ie,g as Re,p as Te,h as Oe}from"./index-DObLpaL1.js";const Le={lineGradientLigthTheme:["linear-gradient(180deg, #FFA7EB 0%, #F026A8 100%)","linear-gradient(180deg, #DFA1FF 0%, #9A36F0 100%)","linear-gradient(180deg, #9EAAFF 0%, #3846F4 100%)","linear-gradient(180deg, #7BE7FF 0%, #1E85E2 100%)","linear-gradient(180deg, #89FED8 0%, #18C997 100%)","linear-gradient(180deg, #FFED48 0%, #FD9E16 100%)","linear-gradient(180deg, #FFBA8D 0%, #EB6423 100%)"],normalLightTheme:["#2B7AF5","#2B9DF5","#79CFFF","#1B67DD","#4F94FF","#2180F2","#3FD0FF"]},ce=[[0,1,0,2,1,2,2,2],[0,1,1,1,1,2,2,2],[1,1,1,2,2,1,2,2],[1,0,1,1,1,2,1,3],[0,2,1,1,1,2,2,1],[0,1,0,2,1,1,2,1],[1,1,2,0,2,1,2,2]],O=[[{x:1,y:1},{x:1,y:0},{x:0,y:-2},{x:-2,y:1}],[{x:1,y:1},{x:1,y:0},{x:0,y:-2},{x:-2,y:1}],[{x:0,y:1},{x:1,y:0},{x:0,y:-1},{x:-1,y:0}],[{x:-1,y:2},{x:1,y:1},{x:2,y:-1},{x:-2,y:-2}],[{x:2,y:0},{x:0,y:-1},{x:-1,y:-1},{x:-1,y:2}],[{x:1,y:1},{x:1,y:0},{x:0,y:-2},{x:-2,y:1}],[{x:0,y:0},{x:1,y:0},{x:-1,y:0},{x:0,y:0}]],de=(g,n)=>{n.splice(0,n.length);for(let v=0;v<ce.length;v++){const m={position:ce[v],color:Le[g][v]};n.push(m)}},x=(g,n,v)=>g*v+n,Ae=(g,n)=>{const v=g.__vccOpts||g;for(const[m,r]of n)v[m]=r;return v},N=g=>(Te("data-v-eec0a631"),g=g(),Oe(),g),Ee={class:"game-container"},Ge={class:"game-left"},Ne={class:"main-frame"},Je={key:0,class:"game-over"},je={class:"operation-box"},Pe={class:"game-right"},Ue={class:"sub-frame"},Ve={class:"data-box"},ze={class:"data-row"},Ke=N(()=>l("div",{class:"data-label"},"清除次数:",-1)),qe={class:"data"},He={class:"data-row"},Qe=N(()=>l("div",{class:"data-label"},"等级:",-1)),We={class:"data"},Xe={class:"data-row"},Ye=N(()=>l("div",{class:"data-label"},"分数:",-1)),Ze={class:"data"},$e={class:"data-row"},et=N(()=>l("div",{class:"data-label"},"速度:",-1)),tt={class:"data"},at={class:"data-row"},ot=N(()=>l("div",{class:"data-label"},"历史记录:",-1)),nt={class:"data"},st={class:"system-box"},lt={__name:"Index",setup(g){const n=_([]),v=_([]),m=d(20),r=d(10),ue=d(4),U=d(4),I=d("#eeeeee"),L=d("lineGradientLigthTheme"),S=_([]),f=_({index:0,transform:0}),C=_({index:0,transform:0});let s=_({}),J=_({}),B=null;const F=_([]),V=d(800),D=d(V.value),W=d(100),ve=d(40),y=d(!1),p=d(!1),A=d(0),M=d(1),j=d(0),fe=d(5),R=d(0),he=()=>{for(let e=0;e<m.value;e++)for(let t=0;t<r.value;t++)n.push(_({data:0,bgColor:I.value}))},ge=()=>{for(let e=0;e<ue.value;e++)for(let t=0;t<U.value;t++)v.push(_({data:0,bgColor:I.value}))},h=(e,t,a,o)=>{const i=e.position;for(let c=0;c<i.length;c+=2)switch(o){case"clear":t[x(i[c],i[c+1],a)].bgColor=I.value;break;case"generate":t[x(i[c],i[c+1],a)].bgColor=e.color;break;case"fix":t[x(i[c],i[c+1],a)].data=1;break}},z=()=>{let e=Math.floor(Math.random()*S.length);for(;e===C.index;)e=Math.floor(Math.random()*S.length);C.index=e,C.transform=Math.floor(Math.random()*4)},K=()=>{f.index=C.index,f.transform=C.transform,s=JSON.parse(JSON.stringify(S[f.index])),$(s,n,r.value,f),z(),J.position&&h(J,v,U.value,"clear"),J=JSON.parse(JSON.stringify(S[C.index])),$(J,v,U.value,C)},xe=()=>{const e=s.position;for(let t=0;t<e.length;t+=2){if(e[t]>=m.value-1)return!1;const a=x(e[t]+1,e[t+1],r.value);if(n[a].data>0)return!1}return!0},me=()=>{const e=s.position;for(let t=0;t<e.length;t+=2){const a=x(e[t],e[t+1]-1,r.value);if(e[t+1]<=0||n[a].data>0)return!1}return!0},pe=()=>{const e=s.position;for(let t=0;t<e.length;t+=2){const a=x(e[t],e[t+1]+1,r.value);if(e[t+1]>=r.value-1||n[a].data>0)return!1}return!0},_e=()=>{const e=JSON.parse(JSON.stringify(s)),t=f.transform,a=f.index,o=e.position,i=o[0],c=o[1];for(let u=0;u<o.length;u+=2){const w=o[u]-i,q=o[u+1]-c,H=i+O[a][t].x,Q=c+O[a][t].y;if(o[u]=q+H,o[u+1]=-w+Q,o[u+1]<0||o[u+1]>=r.value||o[u]>=m.value||n[x(o[u],o[u+1],r.value)].data>0)return!1}return!0},E=()=>{p.value||!y.value||setTimeout(()=>{if(xe()){h(s,n,r.value,"clear");for(let e=0;e<s.position.length;e+=2)s.position[e]++;h(s,n,r.value,"generate")}else h(s,n,r.value,"fix"),we()},0)},X=()=>{p.value||!y.value||setTimeout(()=>{if(me()){h(s,n,r.value,"clear");for(let e=0;e<s.position.length;e+=2)s.position[e+1]--;h(s,n,r.value,"generate")}},0)},Y=()=>{p.value||!y.value||setTimeout(()=>{if(pe()){h(s,n,r.value,"clear");for(let e=0;e<s.position.length;e+=2)s.position[e+1]++;h(s,n,r.value,"generate")}},0)},Z=()=>{p.value||!y.value||setTimeout(()=>{if(_e()){h(s,n,r.value,"clear");const e=s.position[0],t=s.position[1];for(let a=0;a<s.position.length;a+=2){const o=s.position[a]-e,i=s.position[a+1]-t,c=e+O[f.index][f.transform].x,u=t+O[f.index][f.transform].y;s.position[a]=i+c,s.position[a+1]=-o+u}f.transform=(f.transform+1)%4,h(s,n,r.value,"generate")}},0)},$=(e,t,a,o)=>{h(e,t,a,"clear");for(let i=0;i<o.transform;i++){const c=e.position[0],u=e.position[1];for(let w=0;w<e.position.length;w+=2){const q=e.position[w]-c,H=e.position[w+1]-u,Q=c+O[o.index][i].x,Se=u+O[o.index][i].y;e.position[w]=H+Q,e.position[w+1]=-q+Se}}h(e,t,a,"generate")},ye=e=>{A.value+=e*(e+1)/2*100*M.value},Fe=()=>{j.value++,M.value=Math.max(M.value,Math.floor(j.value/fe.value)+1),D.value=V.value-(M.value-1)*ve.value,D.value=Math.max(D.value,W.value),ae()},we=()=>{let e=0;for(let t=m.value-1;t>=0;t--){let a=0;for(let o=0;o<r.value;o++)n[x(t,o,r.value)].data>0&&a++;if(a===0)break;a===r.value&&F.push(t),e++}if(e>=m.value-1){P(),p.value=!0;return}if(F.length>0){for(let t=0;t<F.length;t++)for(let a=0;a<r.value;a++){const o=x(F[t],a,r.value);n[o].bgColor=I.value,n[o].data=0}for(let t=m.value-1;t>=0;t--){let a=0;for(;F[a]>t;)a++;if(a>0)for(let o=0;o<r.value;o++){const i=x(t,o,r.value);if(n[i].data>0){const c=x(t+a,o,r.value);n[c].data=n[i].data,n[c].bgColor=n[i].bgColor,n[i].data=0,n[i].bgColor=I.value}}}ye(F.length),Fe(),F.splice(0,F.length)}K()},T=()=>{B&&(clearInterval(B),B=null)},be=()=>{j.value=0,M.value=0,A.value=0,D.value=V.value},ee=e=>{for(let t=0;t<e.length;t++)e[t].data=0,e[t].bgColor=I.value},te=()=>{be(),ee(n),ee(v),z(),K(),p.value=!1,y.value=!1,T()},ae=()=>{p.value||(y.value=!0,T(),B=setInterval(()=>{E()},D.value))},P=()=>{p.value||(y.value?(y.value=!1,T()):ae())},oe=()=>{L.value==="lineGradientLigthTheme"?L.value="normalLightTheme":L.value="lineGradientLigthTheme"},ke=e=>{e.preventDefault(),T(),B=setInterval(()=>{E()},W.value)},Ce=e=>{e.preventDefault(),T(),B=setInterval(()=>{E()},D.value)},ne=e=>{switch(e.key){case"ArrowUp":Z();break;case"ArrowDown":E();break;case"ArrowLeft":X();break;case"ArrowRight":Y();break;case"Enter":P();break;case"t":oe();break;case"r":te();break}},De=()=>{const e=localStorage.getItem("record");e&&(R.value=parseInt(e))},Ie=()=>{localStorage.setItem("record",R.value)};return Be(()=>{window.addEventListener("keydown",ne),he(),ge(),de(L.value,S),De(),z(),K(),se(L,e=>{de(e,S)}),se(p,e=>{e&&A.value>R.value&&(R.value=A.value,Ie(R.value))})}),Me(()=>{window.removeEventListener("keydown",ne),T()}),(e,t)=>(b(),k("div",Ee,[l("div",Ge,[l("div",Ne,[(b(!0),k(le,null,re(n,(a,o)=>(b(),k("div",{key:o,class:"cell",style:ie({background:a.bgColor})},[p.value?(b(),k("div",Je,"Game Over")):Re("",!0)],4))),128))]),l("div",je,[l("div",{class:"rotate btn",onClick:Z},"旋转"),l("div",{class:"btn",onClick:X},"向左"),l("div",{class:"btn",onClick:Y},"向右"),l("div",{class:"move-down btn",onClick:E,onTouchstart:ke,onTouchend:Ce}," 向下 ",32)])]),l("div",Pe,[l("div",Ue,[(b(!0),k(le,null,re(v,(a,o)=>(b(),k("div",{key:o,class:"cell",style:ie({background:a.bgColor})},null,4))),128))]),l("div",Ve,[l("div",ze,[Ke,l("div",qe,G(j.value),1)]),l("div",He,[Qe,l("div",We,G(M.value),1)]),l("div",Xe,[Ye,l("div",Ze,G(A.value),1)]),l("div",$e,[et,l("div",tt,G(D.value),1)]),l("div",at,[ot,l("div",nt,G(R.value),1)])]),l("div",st,[y.value?(b(),k("div",{key:0,class:"btn",onClick:P},"暂停")):(b(),k("div",{key:1,class:"btn",onClick:P},"开始")),l("div",{class:"btn",onClick:oe},"切换主题"),l("div",{class:"btn",onClick:te},"重新开始")])])]))}},it=Ae(lt,[["__scopeId","data-v-eec0a631"]]);export{it as default};

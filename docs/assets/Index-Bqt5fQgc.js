import{r as p,a as u,o as _e,w as Fe,b as be,c as w,d as k,e as i,F as ee,f as te,t as L,n as ae,g as we,p as ke,h as Ce}from"./index-4rPvDgmg.js";const Be={lineGradientLigthTheme:["linear-gradient(180deg, #FFA7EB 0%, #F026A8 100%)","linear-gradient(180deg, #DFA1FF 0%, #9A36F0 100%)","linear-gradient(180deg, #9EAAFF 0%, #3846F4 100%)","linear-gradient(180deg, #7BE7FF 0%, #1E85E2 100%)","linear-gradient(180deg, #89FED8 0%, #18C997 100%)","linear-gradient(180deg, #FFED48 0%, #FD9E16 100%)","linear-gradient(180deg, #FFBA8D 0%, #EB6423 100%)"],normalLightTheme:["#2B7AF5","#2B9DF5","#79CFFF","#1B67DD","#4F94FF","#2180F2","#3FD0FF"]},oe=[[0,1,0,2,1,2,2,2],[0,1,1,1,1,2,2,2],[1,1,1,2,2,1,2,2],[1,0,1,1,1,2,1,3],[0,2,1,1,1,2,2,1],[0,1,0,2,1,1,2,1],[1,1,2,0,2,1,2,2]],I=[[{x:1,y:1},{x:1,y:0},{x:0,y:-2},{x:-2,y:1}],[{x:1,y:1},{x:1,y:0},{x:0,y:-2},{x:-2,y:1}],[{x:0,y:1},{x:1,y:0},{x:0,y:-1},{x:-1,y:0}],[{x:-1,y:2},{x:1,y:1},{x:2,y:-1},{x:-2,y:-2}],[{x:2,y:0},{x:0,y:-1},{x:-1,y:-1},{x:-1,y:2}],[{x:1,y:1},{x:1,y:0},{x:0,y:-2},{x:-2,y:1}],[{x:0,y:0},{x:1,y:0},{x:-1,y:0},{x:0,y:0}]],ne=(x,n)=>{n.splice(0,n.length);for(let v=0;v<oe.length;v++){const m={position:oe[v],color:Be[x][v]};n.push(m)}},g=(x,n,v)=>x*v+n,De=(x,n)=>{const v=x.__vccOpts||x;for(const[m,l]of n)v[m]=l;return v},G=x=>(ke("data-v-eb258713"),x=x(),Ce(),x),Ie={class:"game-container"},Oe={class:"game-left"},Se={class:"main-frame"},Me={key:0,class:"game-over"},Re={class:"game-right"},Ae={class:"sub-frame"},Ee={class:"data-box"},Le={class:"data-row"},Ge=G(()=>i("div",{class:"data-label"},"清除次数:",-1)),Ne={class:"data"},Te={class:"data-row"},Je=G(()=>i("div",{class:"data-label"},"等级:",-1)),je={class:"data"},Ue={class:"data-row"},Pe=G(()=>i("div",{class:"data-label"},"分数:",-1)),Ve={class:"data"},ze={class:"data-row"},Ke=G(()=>i("div",{class:"data-label"},"速度:",-1)),qe={class:"data"},He={class:"system-box"},Qe={__name:"Index",setup(x){const n=p([]),v=p([]),m=u(20),l=u(10),se=u(4),N=u(4),O=u("#eeeeee"),S=u("lineGradientLigthTheme"),B=p([]),f=p({index:0,transform:0}),C=p({index:0,transform:0});let s=p({}),A=p({});const y=p([]);let D=null;const V=u(800),M=u(V.value),le=u(100),ie=u(40),_=u(!1),F=u(!1),z=u(0),R=u(1),T=u(0),re=u(5),ce=()=>{for(let e=0;e<m.value;e++)for(let t=0;t<l.value;t++)n.push(p({data:0,bgColor:O.value}))},de=()=>{for(let e=0;e<se.value;e++)for(let t=0;t<N.value;t++)v.push(p({data:0,bgColor:O.value}))},h=(e,t,a,o)=>{const r=e.position;for(let c=0;c<r.length;c+=2)switch(o){case"clear":t[g(r[c],r[c+1],a)].bgColor=O.value;break;case"generate":t[g(r[c],r[c+1],a)].bgColor=e.color;break;case"fix":t[g(r[c],r[c+1],a)].data=1;break}},K=()=>{let e=Math.floor(Math.random()*B.length);for(;e===C.index;)e=Math.floor(Math.random()*B.length);C.index=e,C.transform=Math.floor(Math.random()*4)},q=()=>{f.index=C.index,f.transform=C.transform,s=JSON.parse(JSON.stringify(B[f.index])),X(s,n,l.value,f),K(),A.position&&h(A,v,N.value,"clear"),A=JSON.parse(JSON.stringify(B[C.index])),X(A,v,N.value,C)},ue=()=>{const e=s.position;for(let t=0;t<e.length;t+=2){if(e[t]>=m.value-1)return!1;const a=g(e[t]+1,e[t+1],l.value);if(n[a].data>0)return!1}return!0},ve=()=>{const e=s.position;for(let t=0;t<e.length;t+=2){const a=g(e[t],e[t+1]-1,l.value);if(e[t+1]<=0||n[a].data>0)return!1}return!0},fe=()=>{const e=s.position;for(let t=0;t<e.length;t+=2){const a=g(e[t],e[t+1]+1,l.value);if(e[t+1]>=l.value-1||n[a].data>0)return!1}return!0},he=()=>{const e=JSON.parse(JSON.stringify(s)),t=f.transform,a=f.index,o=e.position,r=o[0],c=o[1];for(let d=0;d<o.length;d+=2){const b=o[d]-r,j=o[d+1]-c,U=r+I[a][t].x,P=c+I[a][t].y;if(o[d]=j+U,o[d+1]=-b+P,o[d+1]<0||o[d+1]>=l.value||o[d]>=m.value||n[g(o[d],o[d+1],l.value)].data>0)return!1}return!0},J=()=>{if(!(F.value||!_.value))if(ue()){h(s,n,l.value,"clear");for(let e=0;e<s.position.length;e+=2)s.position[e]++;h(s,n,l.value,"generate")}else h(s,n,l.value,"fix"),me()},H=()=>{if(!(F.value||!_.value)&&ve()){h(s,n,l.value,"clear");for(let e=0;e<s.position.length;e+=2)s.position[e+1]--;h(s,n,l.value,"generate")}},Q=()=>{if(!(F.value||!_.value)&&fe()){h(s,n,l.value,"clear");for(let e=0;e<s.position.length;e+=2)s.position[e+1]++;h(s,n,l.value,"generate")}},W=()=>{if(!(F.value||!_.value)&&he()){h(s,n,l.value,"clear");const e=s.position[0],t=s.position[1];for(let a=0;a<s.position.length;a+=2){const o=s.position[a]-e,r=s.position[a+1]-t,c=e+I[f.index][f.transform].x,d=t+I[f.index][f.transform].y;s.position[a]=r+c,s.position[a+1]=-o+d}f.transform=(f.transform+1)%4,h(s,n,l.value,"generate")}},X=(e,t,a,o)=>{h(e,t,a,"clear");for(let r=0;r<o.transform;r++){const c=e.position[0],d=e.position[1];for(let b=0;b<e.position.length;b+=2){const j=e.position[b]-c,U=e.position[b+1]-d,P=c+I[o.index][r].x,ye=d+I[o.index][r].y;e.position[b]=U+P,e.position[b+1]=-j+ye}}h(e,t,a,"generate")},xe=e=>{z.value+=e*(e+1)/2*100*R.value},ge=()=>{T.value++,R.value=Math.max(R.value,Math.floor(T.value/re.value)+1),M.value=V.value-(R.value-1)*ie.value,M.value=Math.max(M.value,le.value),Y()},me=()=>{let e=0;for(let t=m.value-1;t>=0;t--){let a=0;for(let o=0;o<l.value;o++)n[g(t,o,l.value)].data>0&&a++;if(a===0)break;a===l.value&&y.push(t),e++}if(e>=m.value-1){E(),F.value=!0;return}if(y.length>0){for(let t=0;t<y.length;t++)for(let a=0;a<l.value;a++){const o=g(y[t],a,l.value);n[o].bgColor=O.value,n[o].data=0}for(let t=m.value-1;t>=0;t--){let a=0;for(;y[a]>t;)a++;if(a>0)for(let o=0;o<l.value;o++){const r=g(t,o,l.value);if(n[r].data>0){const c=g(t+a,o,l.value);n[c].data=n[r].data,n[c].bgColor=n[r].bgColor,n[r].data=0,n[r].bgColor=O.value}}}xe(y.length),ge(),y.splice(0,y.length)}q()},Y=()=>{F.value||(_.value=!0,D&&clearInterval(D),D=setInterval(()=>{J()},M.value))},E=()=>{F.value||(_.value?(_.value=!1,clearInterval(D)):Y())},Z=()=>{S.value==="lineGradientLigthTheme"?S.value="normalLightTheme":S.value="lineGradientLigthTheme"},pe=()=>{ce(),de()},$=e=>{switch(e.key){case"ArrowUp":W();break;case"ArrowDown":J();break;case"ArrowLeft":H();break;case"ArrowRight":Q();break;case"Enter":E();break;case"t":Z();break}};return _e(()=>{window.addEventListener("keydown",$),pe(),ne(S.value,B),K(),q(),Fe(S,e=>{ne(e,B)})}),be(()=>{window.removeEventListener("keydown",$),D&&clearInterval(D)}),(e,t)=>(w(),k("div",Ie,[i("div",Oe,[i("div",Se,[(w(!0),k(ee,null,te(n,(a,o)=>(w(),k("div",{key:o,class:"cell",style:ae({background:a.bgColor})},[F.value?(w(),k("div",Me,"Game Over")):we("",!0)],4))),128))]),i("div",{class:"operation-box"},[i("div",{class:"rotate btn",onClick:W},"旋转"),i("div",{class:"btn",onClick:H},"向左"),i("div",{class:"btn",onClick:Q},"向右"),i("div",{class:"move-down btn",onClick:J},"向下")])]),i("div",Re,[i("div",Ae,[(w(!0),k(ee,null,te(v,(a,o)=>(w(),k("div",{key:o,class:"cell",style:ae({background:a.bgColor})},null,4))),128))]),i("div",Ee,[i("div",Le,[Ge,i("div",Ne,L(T.value),1)]),i("div",Te,[Je,i("div",je,L(R.value),1)]),i("div",Ue,[Pe,i("div",Ve,L(z.value),1)]),i("div",ze,[Ke,i("div",qe,L(M.value),1)])]),i("div",He,[_.value?(w(),k("div",{key:1,class:"btn",onClick:E}," 开始 ")):(w(),k("div",{key:0,class:"btn",onClick:E}," 暂停 ")),i("div",{class:"btn",onClick:Z},"切换主题")])])]))}},Xe=De(Qe,[["__scopeId","data-v-eb258713"]]);export{Xe as default};

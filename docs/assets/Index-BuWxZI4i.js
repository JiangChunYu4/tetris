import{r as _,a as d,o as Ie,w as le,b as Ee,c as b,d as k,e as r,F as re,f as ie,t as G,n as ce,g as Se,p as Be,h as Me}from"./index-Bnfaa_bu.js";const Oe={lineGradientLigthTheme:["linear-gradient(180deg, #FFA7EB 0%, #F026A8 100%)","linear-gradient(180deg, #DFA1FF 0%, #9A36F0 100%)","linear-gradient(180deg, #9EAAFF 0%, #3846F4 100%)","linear-gradient(180deg, #7BE7FF 0%, #1E85E2 100%)","linear-gradient(180deg, #89FED8 0%, #18C997 100%)","linear-gradient(180deg, #FFED48 0%, #FD9E16 100%)","linear-gradient(180deg, #FFBA8D 0%, #EB6423 100%)"],normalLightTheme:["#2B7AF5","#2B9DF5","#79CFFF","#1B67DD","#4F94FF","#2180F2","#3FD0FF"]},de=[[0,1,0,2,1,2,2,2],[0,1,1,1,1,2,2,2],[1,1,1,2,2,1,2,2],[1,0,1,1,1,2,1,3],[0,2,1,1,1,2,2,1],[0,1,0,2,1,1,2,1],[1,1,2,0,2,1,2,2]],M=[[{x:1,y:1},{x:1,y:0},{x:0,y:-2},{x:-2,y:1}],[{x:1,y:1},{x:1,y:0},{x:0,y:-2},{x:-2,y:1}],[{x:0,y:1},{x:1,y:0},{x:0,y:-1},{x:-1,y:0}],[{x:-1,y:2},{x:1,y:1},{x:2,y:-1},{x:-2,y:-2}],[{x:2,y:0},{x:0,y:-1},{x:-1,y:-1},{x:-1,y:2}],[{x:1,y:1},{x:1,y:0},{x:0,y:-2},{x:-2,y:1}],[{x:0,y:0},{x:1,y:0},{x:-1,y:0},{x:0,y:0}]],ue=(g,n)=>{n.splice(0,n.length);for(let v=0;v<de.length;v++){const m={position:de[v],color:Oe[g][v]};n.push(m)}},x=(g,n,v)=>g*v+n,Le=(g,n)=>{const v=g.__vccOpts||g;for(const[m,s]of n)v[m]=s;return v},N=g=>(Be("data-v-4175d020"),g=g(),Me(),g),Ae={class:"game-container"},Ge={class:"game-left"},Ne={class:"main-frame"},Je={key:0,class:"game-over"},je={class:"operation-box"},Pe={class:"game-right"},Ue={class:"sub-frame"},Ve={class:"data-box"},ze={class:"data-row"},Ke=N(()=>r("div",{class:"data-label"},"清除次数:",-1)),qe={class:"data"},He={class:"data-row"},Qe=N(()=>r("div",{class:"data-label"},"等级:",-1)),We={class:"data"},Xe={class:"data-row"},Ye=N(()=>r("div",{class:"data-label"},"分数:",-1)),Ze={class:"data"},$e={class:"data-row"},et=N(()=>r("div",{class:"data-label"},"速度:",-1)),tt={class:"data"},at={class:"data-row"},ot=N(()=>r("div",{class:"data-label"},"历史记录:",-1)),nt={class:"data"},st={class:"system-box"},lt={__name:"Index",setup(g){const n=_([]),v=_([]),m=d(24),s=d(10),U=d(4),V=d(4),R=d("#eeeeee"),O=d("lineGradientLigthTheme"),T=_([]),f=_({index:0,transform:0}),C=_({index:0,transform:0});let l=_({}),J=_({}),I=null;const F=_([]),z=d(800),D=d(z.value),X=d(100),ve=d(40),y=d(!1),p=d(!1),L=d(0),E=d(1),j=d(0),fe=d(5),S=d(0),he=()=>{for(let e=0;e<m.value;e++)for(let t=0;t<s.value;t++)n.push(_({data:0,bgColor:R.value}))},ge=()=>{for(let e=0;e<U.value;e++)for(let t=0;t<V.value;t++)v.push(_({data:0,bgColor:R.value}))},h=(e,t,a,o)=>{const i=e.position;for(let c=0;c<i.length;c+=2)switch(o){case"clear":t[x(i[c],i[c+1],a)].bgColor=R.value;break;case"generate":t[x(i[c],i[c+1],a)].bgColor=e.color;break;case"fix":t[x(i[c],i[c+1],a)].data=1;break}},K=()=>{let e=Math.floor(Math.random()*T.length);for(;e===C.index;)e=Math.floor(Math.random()*T.length);C.index=e,C.transform=Math.floor(Math.random()*4)},q=()=>{f.index=C.index,f.transform=C.transform,l=JSON.parse(JSON.stringify(T[f.index])),ee(l,n,s.value,f),K(),J.position&&h(J,v,V.value,"clear"),J=JSON.parse(JSON.stringify(T[C.index])),ee(J,v,V.value,C)},xe=()=>{const e=l.position;for(let t=0;t<e.length;t+=2){if(e[t]>=m.value-1)return!1;const a=x(e[t]+1,e[t+1],s.value);if(n[a].data>0)return!1}return!0},me=()=>{const e=l.position;for(let t=0;t<e.length;t+=2){const a=x(e[t],e[t+1]-1,s.value);if(e[t+1]<=0||n[a].data>0)return!1}return!0},pe=()=>{const e=l.position;for(let t=0;t<e.length;t+=2){const a=x(e[t],e[t+1]+1,s.value);if(e[t+1]>=s.value-1||n[a].data>0)return!1}return!0},_e=()=>{const e=JSON.parse(JSON.stringify(l)),t=f.transform,a=f.index,o=e.position,i=o[0],c=o[1];for(let u=0;u<o.length;u+=2){const w=o[u]-i,H=o[u+1]-c,Q=i+M[a][t].x,W=c+M[a][t].y;if(o[u]=H+Q,o[u+1]=-w+W,o[u+1]<0||o[u+1]>=s.value||o[u]>=m.value||n[x(o[u],o[u+1],s.value)].data>0)return!1}return!0},A=()=>{p.value||!y.value||setTimeout(()=>{if(xe()){h(l,n,s.value,"clear");for(let e=0;e<l.position.length;e+=2)l.position[e]++;h(l,n,s.value,"generate")}else h(l,n,s.value,"fix"),we()},0)},Y=()=>{p.value||!y.value||setTimeout(()=>{if(me()){h(l,n,s.value,"clear");for(let e=0;e<l.position.length;e+=2)l.position[e+1]--;h(l,n,s.value,"generate")}},0)},Z=()=>{p.value||!y.value||setTimeout(()=>{if(pe()){h(l,n,s.value,"clear");for(let e=0;e<l.position.length;e+=2)l.position[e+1]++;h(l,n,s.value,"generate")}},0)},$=()=>{p.value||!y.value||setTimeout(()=>{if(_e()){h(l,n,s.value,"clear");const e=l.position[0],t=l.position[1];for(let a=0;a<l.position.length;a+=2){const o=l.position[a]-e,i=l.position[a+1]-t,c=e+M[f.index][f.transform].x,u=t+M[f.index][f.transform].y;l.position[a]=i+c,l.position[a+1]=-o+u}f.transform=(f.transform+1)%4,h(l,n,s.value,"generate")}},0)},ee=(e,t,a,o)=>{h(e,t,a,"clear");for(let i=0;i<o.transform;i++){const c=e.position[0],u=e.position[1];for(let w=0;w<e.position.length;w+=2){const H=e.position[w]-c,Q=e.position[w+1]-u,W=c+M[o.index][i].x,Te=u+M[o.index][i].y;e.position[w]=Q+W,e.position[w+1]=-H+Te}}h(e,t,a,"generate")},ye=e=>{L.value+=e*(e+1)/2*100*E.value},Fe=()=>{j.value++,E.value=Math.max(E.value,Math.floor(j.value/fe.value)+1),D.value=z.value-(E.value-1)*ve.value,D.value=Math.max(D.value,X.value),oe()},we=()=>{let e=0;for(let t=m.value-1;t>=0;t--){let a=0;for(let o=0;o<s.value;o++)n[x(t,o,s.value)].data>0&&a++;if(a===0)break;a===s.value&&F.push(t),e++}if(e>=m.value-U.value){P(),p.value=!0;return}if(F.length>0){for(let t=0;t<F.length;t++)for(let a=0;a<s.value;a++){const o=x(F[t],a,s.value);n[o].bgColor=R.value,n[o].data=0}for(let t=m.value-1;t>=0;t--){let a=0;for(;F[a]>t;)a++;if(a>0)for(let o=0;o<s.value;o++){const i=x(t,o,s.value);if(n[i].data>0){const c=x(t+a,o,s.value);n[c].data=n[i].data,n[c].bgColor=n[i].bgColor,n[i].data=0,n[i].bgColor=R.value}}}ye(F.length),Fe(),F.splice(0,F.length)}q()},B=()=>{I&&(clearInterval(I),I=null)},be=()=>{j.value=0,E.value=0,L.value=0,D.value=z.value},te=e=>{for(let t=0;t<e.length;t++)e[t].data=0,e[t].bgColor=R.value},ae=()=>{be(),te(n),te(v),K(),q(),p.value=!1,y.value=!1,B()},oe=()=>{p.value||(y.value=!0,B(),I=setInterval(()=>{A()},D.value))},P=()=>{p.value||(y.value?(y.value=!1,B()):oe())},ne=()=>{O.value==="lineGradientLigthTheme"?O.value="normalLightTheme":O.value="lineGradientLigthTheme"},ke=e=>{e.preventDefault(),B(),I=setInterval(()=>{A()},X.value)},Ce=e=>{e.preventDefault(),B(),I=setInterval(()=>{A()},D.value)},se=e=>{switch(e.key){case"ArrowUp":$();break;case"ArrowDown":A();break;case"ArrowLeft":Y();break;case"ArrowRight":Z();break;case"Enter":P();break;case"t":ne();break;case"r":ae();break}},De=()=>{const e=localStorage.getItem("record");e&&(S.value=parseInt(e))},Re=()=>{localStorage.setItem("record",S.value)};return Ie(()=>{window.addEventListener("keydown",se),he(),ge(),ue(O.value,T),De(),K(),q(),le(O,e=>{ue(e,T)}),le(p,e=>{e&&L.value>S.value&&(S.value=L.value,Re(S.value))})}),Ee(()=>{window.removeEventListener("keydown",se),B()}),(e,t)=>(b(),k("div",Ae,[r("div",Ge,[r("div",Ne,[(b(!0),k(re,null,ie(n.slice(s.value*U.value),(a,o)=>(b(),k("div",{key:o,class:"cell",style:ce({background:a.bgColor})},[p.value?(b(),k("div",Je,"Game Over")):Se("",!0)],4))),128))]),r("div",je,[r("div",{class:"rotate btn",onClick:$},"旋转"),r("div",{class:"btn",onClick:Y},"向左"),r("div",{class:"btn",onClick:Z},"向右"),r("div",{class:"move-down btn",onClick:A,onTouchstart:ke,onTouchend:Ce}," 向下 ",32)])]),r("div",Pe,[r("div",Ue,[(b(!0),k(re,null,ie(v,(a,o)=>(b(),k("div",{key:o,class:"cell",style:ce({background:a.bgColor})},null,4))),128))]),r("div",Ve,[r("div",ze,[Ke,r("div",qe,G(j.value),1)]),r("div",He,[Qe,r("div",We,G(E.value),1)]),r("div",Xe,[Ye,r("div",Ze,G(L.value),1)]),r("div",$e,[et,r("div",tt,G(D.value),1)]),r("div",at,[ot,r("div",nt,G(S.value),1)])]),r("div",st,[y.value?(b(),k("div",{key:0,class:"btn",onClick:P},"暂停 ENTER")):(b(),k("div",{key:1,class:"btn",onClick:P},"开始 ENTER")),r("div",{class:"btn",onClick:ne},"切换主题 T"),r("div",{class:"btn",onClick:ae},"重新开始 R")])])]))}},it=Le(lt,[["__scopeId","data-v-4175d020"]]);export{it as default};

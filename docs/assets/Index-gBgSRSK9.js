import{r as m,a as u,o as _e,w as Fe,b as we,c as B,d as D,e as be,f as r,F as ee,g as te,t as E,n as ae,p as ke,h as Ce}from"./index-kQm4DRmv.js";const Be={lineGradientLigthTheme:["linear-gradient(180deg, #FFA7EB 0%, #F026A8 100%)","linear-gradient(180deg, #DFA1FF 0%, #9A36F0 100%)","linear-gradient(180deg, #9EAAFF 0%, #3846F4 100%)","linear-gradient(180deg, #7BE7FF 0%, #1E85E2 100%)","linear-gradient(180deg, #89FED8 0%, #18C997 100%)","linear-gradient(180deg, #FFED48 0%, #FD9E16 100%)","linear-gradient(180deg, #FFBA8D 0%, #EB6423 100%)"],normalLightTheme:["#2B7AF5","#2B9DF5","#79CFFF","#1B67DD","#4F94FF","#2180F2","#3FD0FF"]},oe=[[0,1,0,2,1,2,2,2],[0,1,1,1,1,2,2,2],[1,1,1,2,2,1,2,2],[1,0,1,1,1,2,1,3],[0,2,1,1,1,2,2,1],[0,1,0,2,1,1,2,1],[1,1,2,0,2,1,2,2]],I=[[{x:1,y:1},{x:1,y:0},{x:0,y:-2},{x:-2,y:1}],[{x:1,y:1},{x:1,y:0},{x:0,y:-2},{x:-2,y:1}],[{x:0,y:1},{x:1,y:0},{x:0,y:-1},{x:-1,y:0}],[{x:-1,y:2},{x:1,y:1},{x:2,y:-1},{x:-2,y:-2}],[{x:2,y:0},{x:0,y:-1},{x:-1,y:-1},{x:-1,y:2}],[{x:1,y:1},{x:1,y:0},{x:0,y:-2},{x:-2,y:1}],[{x:0,y:0},{x:1,y:0},{x:-1,y:0},{x:0,y:0}]],ne=(x,n)=>{n.splice(0,n.length);for(let v=0;v<oe.length;v++){const p={position:oe[v],color:Be[x][v]};n.push(p)}},g=(x,n,v)=>x*v+n,De=(x,n)=>{const v=x.__vccOpts||x;for(const[p,l]of n)v[p]=l;return v},L=x=>(ke("data-v-7d2197c9"),x=x(),Ce(),x),Ie={class:"game-container"},Oe={key:0,class:"game-over"},Se={class:"game-left"},Me={class:"main-frame"},Re={class:"game-right"},Ae={class:"sub-frame"},Ee={class:"data-box"},Le={class:"data-row"},Ge=L(()=>r("div",{class:"data-label"},"清除次数:",-1)),Ne={class:"data"},Te={class:"data-row"},Je=L(()=>r("div",{class:"data-label"},"等级:",-1)),je={class:"data"},Ue={class:"data-row"},Pe=L(()=>r("div",{class:"data-label"},"分数:",-1)),Ve={class:"data"},ze={class:"data-row"},Ke=L(()=>r("div",{class:"data-label"},"速度:",-1)),qe={class:"data"},He={__name:"Index",setup(x){const n=m([]),v=m([]),p=u(20),l=u(10),se=u(4),G=u(4),O=u("#eeeeee"),S=u("lineGradientLigthTheme"),k=m([]),f=m({index:0,transform:0}),w=m({index:0,transform:0});let s=m({}),A=m({});const y=m([]);let C=null;const V=u(800),M=u(V.value),le=u(100),re=u(40),b=u(!1),_=u(!1),z=u(0),R=u(1),N=u(0),ie=u(10),ce=()=>{for(let e=0;e<p.value;e++)for(let t=0;t<l.value;t++)n.push(m({data:0,bgColor:O.value}))},de=()=>{for(let e=0;e<se.value;e++)for(let t=0;t<G.value;t++)v.push(m({data:0,bgColor:O.value}))},h=(e,t,a,o)=>{const i=e.position;for(let c=0;c<i.length;c+=2)switch(o){case"clear":t[g(i[c],i[c+1],a)].bgColor=O.value;break;case"generate":t[g(i[c],i[c+1],a)].bgColor=e.color;break;case"fix":t[g(i[c],i[c+1],a)].data=1;break}},K=()=>{let e=Math.floor(Math.random()*k.length);for(;e===w.index;)e=Math.floor(Math.random()*k.length);w.index=e,w.transform=Math.floor(Math.random()*4)},q=()=>{f.index=w.index,f.transform=w.transform,s=JSON.parse(JSON.stringify(k[f.index])),X(s,n,l.value,f),K(),A.position&&h(A,v,G.value,"clear"),A=JSON.parse(JSON.stringify(k[w.index])),X(A,v,G.value,w)},ue=()=>{const e=s.position;for(let t=0;t<e.length;t+=2){if(e[t]>=p.value-1)return!1;const a=g(e[t]+1,e[t+1],l.value);if(n[a].data>0)return!1}return!0},ve=()=>{const e=s.position;for(let t=0;t<e.length;t+=2){const a=g(e[t],e[t+1]-1,l.value);if(e[t+1]<=0||n[a].data>0)return!1}return!0},fe=()=>{const e=s.position;for(let t=0;t<e.length;t+=2){const a=g(e[t],e[t+1]+1,l.value);if(e[t+1]>=l.value-1||n[a].data>0)return!1}return!0},he=()=>{const e=JSON.parse(JSON.stringify(s)),t=f.transform,a=f.index,o=e.position,i=o[0],c=o[1];for(let d=0;d<o.length;d+=2){const F=o[d]-i,j=o[d+1]-c,U=i+I[a][t].x,P=c+I[a][t].y;if(o[d]=j+U,o[d+1]=-F+P,o[d+1]<0||o[d+1]>=l.value||o[d]>=p.value||n[g(o[d],o[d+1],l.value)].data>0)return!1}return!0},T=()=>{if(!(_.value||!b.value))if(ue()){h(s,n,l.value,"clear");for(let e=0;e<s.position.length;e+=2)s.position[e]++;h(s,n,l.value,"generate")}else h(s,n,l.value,"fix"),pe()},H=()=>{if(!(_.value||!b.value)&&ve()){h(s,n,l.value,"clear");for(let e=0;e<s.position.length;e+=2)s.position[e+1]--;h(s,n,l.value,"generate")}},Q=()=>{if(!(_.value||!b.value)&&fe()){h(s,n,l.value,"clear");for(let e=0;e<s.position.length;e+=2)s.position[e+1]++;h(s,n,l.value,"generate")}},W=()=>{if(!(_.value||!b.value)&&he()){h(s,n,l.value,"clear");const e=s.position[0],t=s.position[1];for(let a=0;a<s.position.length;a+=2){const o=s.position[a]-e,i=s.position[a+1]-t,c=e+I[f.index][f.transform].x,d=t+I[f.index][f.transform].y;s.position[a]=i+c,s.position[a+1]=-o+d}f.transform=(f.transform+1)%4,h(s,n,l.value,"generate")}},X=(e,t,a,o)=>{h(e,t,a,"clear");for(let i=0;i<o.transform;i++){const c=e.position[0],d=e.position[1];for(let F=0;F<e.position.length;F+=2){const j=e.position[F]-c,U=e.position[F+1]-d,P=c+I[o.index][i].x,ye=d+I[o.index][i].y;e.position[F]=U+P,e.position[F+1]=-j+ye}}h(e,t,a,"generate")},xe=e=>{z.value+=e*(e+1)/2*100*R.value},ge=()=>{N.value++,R.value=Math.max(R.value,Math.floor(N.value/ie.value)+1),M.value=V.value-(R.value-1)*re.value,M.value=Math.max(M.value,le.value),Y()},pe=()=>{let e=0;for(let t=p.value-1;t>=0;t--){let a=0;for(let o=0;o<l.value;o++)n[g(t,o,l.value)].data>0&&a++;if(a===0)break;a===l.value&&y.push(t),e++}if(e>=p.value-1){J(),_.value=!0;return}if(y.length>0){for(let t=0;t<y.length;t++)for(let a=0;a<l.value;a++){const o=g(y[t],a,l.value);n[o].bgColor=O.value,n[o].data=0}for(let t=p.value-1;t>=0;t--){let a=0;for(;y[a]>t;)a++;if(a>0)for(let o=0;o<l.value;o++){const i=g(t,o,l.value);if(n[i].data>0){const c=g(t+a,o,l.value);n[c].data=n[i].data,n[c].bgColor=n[i].bgColor,n[i].data=0,n[i].bgColor=O.value}}}xe(y.length),ge(),y.splice(0,y.length)}q()},Y=()=>{_.value||(b.value=!0,C&&clearInterval(C),C=setInterval(()=>{T()},M.value))},J=()=>{_.value||(b.value?(b.value=!1,clearInterval(C)):Y())},Z=()=>{S.value==="lineGradientLigthTheme"?S.value="normalLightTheme":S.value="lineGradientLigthTheme"},me=()=>{ce(),de()},$=e=>{switch(e.key){case"ArrowUp":W();break;case"ArrowDown":T();break;case"ArrowLeft":H();break;case"ArrowRight":Q();break;case"Enter":J();break;case"t":Z();break}};return _e(()=>{window.addEventListener("keydown",$),me(),ne(S.value,k),K(),q(),Fe(S,e=>{ne(e,k)})}),we(()=>{window.removeEventListener("keydown",$),C&&clearInterval(C)}),(e,t)=>(B(),D("div",Ie,[_.value?(B(),D("div",Oe,"Game Over")):be("",!0),r("div",Se,[r("div",Me,[(B(!0),D(ee,null,te(n,(a,o)=>(B(),D("div",{key:o,class:"cell",style:ae({background:a.bgColor})},null,4))),128))]),r("div",{class:"operation-box"},[r("div",{class:"pause btn",onClick:J},"暂停"),r("div",{class:"btn",onClick:Z},"主题"),r("div",{class:"rotate btn",onClick:W},"旋转"),r("div",{class:"btn",onClick:H},"向左"),r("div",{class:"btn",onClick:Q},"向右"),r("div",{class:"move-down btn",onClick:T},"向下")])]),r("div",Re,[r("div",Ae,[(B(!0),D(ee,null,te(v,(a,o)=>(B(),D("div",{key:o,class:"cell",style:ae({background:a.bgColor})},null,4))),128))]),r("div",Ee,[r("div",Le,[Ge,r("div",Ne,E(N.value),1)]),r("div",Te,[Je,r("div",je,E(R.value),1)]),r("div",Ue,[Pe,r("div",Ve,E(z.value),1)]),r("div",ze,[Ke,r("div",qe,E(M.value),1)])])])]))}},We=De(He,[["__scopeId","data-v-7d2197c9"]]);export{We as default};
